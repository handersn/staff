<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.staff.dao.StaffDao">

  <resultMap type="Staff" id="staffMap">
    <id column="eno" property="eno"/>
    <result column="position" property="position"/>
    <result column="name" property="name"/>
    <result column="email" property="email"/>
    <result column="phone" property="phone"/>
  </resultMap>
  
  <sql id="staffSelect">
  	SELECT eno,position,name,email,phone
  	FROM members
  </sql>
  
  <select id="selectAllStaffs" resultMap="staffMap">
    <include refid="staffSelect"/>
  </select>
  
  <select id="selectStaffByEno" parameterType="int" resultType="staffMap">
  	<include refid="staffSelect"/>
  	WHERE eno = #{eno}
  </select>
  
  <select id="selectStaffsByName" parameterType="String" resultType="staffMap">
  	<include refid="staffSelect"/>
  	WHERE name = #{name}
  </select>
  
  <select id="selectStaffsByPosition" parameterType="String" resultType="staffMap">
  	<include refid="staffSelect"/>
  	WHERE position = #{position}
  </select>
  
  <insert id="insert" parameterType="Staff">
    INSERT INTO members(position,name,email,phone) 
    VALUES (#{position}, #{name}, #{sex}, #{birthDate}, #{phone}, #{selectLocal})
  </insert>
  
	<select id="selectGroupMembers" parameterType="int" resultType="map">
		SELECT uname, birth, nick, phone, sex, myphoto, intro,
		T2.manager_status
		FROM members T1, gmembers T2
		WHERE T2.gno = #{gno} and
		T1.MNO = T2.MNO
	</select>
	
  <update id="update" parameterType="Staff">
    UPDATE MEMBERS 
    SET email = #{email},
        uname = #{userName},
        birth = #{birthDate},
        nick = #{nickName}, 
        phone = #{phone}, 
        sex = #{sex}, 
        intro = #{introWord}, 
        lcode = #{selectLocal}
    WHERE mno = #{memberNo}
  </update>
  
</mapper>
